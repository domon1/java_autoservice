<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
</head>
<body>
<!-- Навигационная панель  -->
<div th:replace="~{navbar::navigation}"></div>

<div class="container">
    <form class="row g-3" method="POST">
        <div class="col-md-6">
            <label for="inputCarMark" class="form-label">Марка</label>
                <select class="form-select" id="inputCarMark" aria-label="Default select example" name="mark"
                         onchange="markClick(this)">
                    <option th:each="carMark : ${carMarks}"
                            th:text="${carMark.name}"
                            th:value="${carMark.id}"
                    />  <!-- TODO добавить вызов markClick() при загрузке -->
                </select>
        </div>
        <div class="col-md-6">
            <label for="inputCarModel" class="form-label">Модель</label>
                <select class="form-select" id="inputCarModel" aria-label="Default select example" name="model">
                    <option th:each="carModel : ${carModels}"
                            th:text="${carModel.name}"
                            th:value="${carModel.mark.id}"
                    />
                </select>
        </div>
        <div class="col-md-6">
            <label for="inputDate" class="form-label" id="datePicker">
                Выберите время</label>
            <input type="date" class="form-control" id="inputDate" name="date"
                   onchange="datePick(this)" th:min="${locDate}">
        </div>
        <div class="col-md-6">
            <label for="inputTime" class="form-label">Свободное время</label>
            <select class="form-select" id="inputTime" aria-label="Default select example" name="time">
                <option th:each="time : ${times}"
                        th:text="${time.timeValue}"
                        th:value="${time.id}"
                />
            </select>
        </div>
    </form>
</div>

<script>
    function markClick(select){
        const selectedOption = select.options[select.selectedIndex];
        const modelOption = document.getElementById("inputCarModel").options;
        for(let i=0; i<modelOption.length; i++){
            modelOption[i].removeAttribute('hidden');
        }
        for(let i=0; i<modelOption.length; i++){
            if (modelOption[i].value !== selectedOption.value){
                modelOption[i].setAttribute('hidden', true);
            }
        }
    }

    function datePick(select){
        const selectedDate = select.value;
        alert(selectedDate);
        // TODO добавить вычисление свободного времени для select'а со временем
    }

</script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.min.js"
        integrity="sha384-heAjqF+bCxXpCWLa6Zhcp4fu20XoNIA98ecBC1YkdXhszjoejr5y9Q77hIrv8R9i"
        crossorigin="anonymous"></script>
</body>
</html>